<% if @issue.safe_attribute?('typology_id') && (@project.present? && @project.module_enabled?(:typologies)) %>
  <% typologies = @project.typologies.reject { |t| @project.trackers_for(typology: t).present? && @project.trackers_for(typology: t).exclude?(@issue.tracker) } %>

  <% if typologies.present? %>
    <p>
      <%= f.select :typology_id,
                   typologies.collect { |t| [t.name, t.id] },
                   include_blank: true,
                   required: @issue.required_attribute?('typology_id') %>
    </p>
  <% end %>
<% end %>
